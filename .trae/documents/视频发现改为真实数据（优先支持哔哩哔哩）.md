## 目标

* 移除“视频发现/搜索”的模拟素材，统一改为真实抓取。

* 先实现并启用哔哩哔哩（Bilibili）平台的真实数据拉取，作为默认来源。

## 现状梳理

* 路由：`api/routes/videos.ts` 的 `/discover` 和 `/search` 现在有“真实→失败回退到模拟”的逻辑。

* 管理器：`api/services/platformManager.ts` 中 Bilibili 爬虫被注释掉（接口不匹配）。

* 爬虫：`api/services/platformCrawlers/bilibiliCrawler.ts` 已提供真实抓取（搜索API与用户投稿），但存在：

  * 方法签名与 `PlatformCrawler` 接口不完全一致（例如 `searchVideos(keyword, page, limit)`）。

  * 在出错时仍回退到内部 mock。

## 实施方案

### 1. 启用并对齐 Bilibili 爬虫

* 在 `PlatformManager.initializeCrawlers()` 中注册 `bilibili`。

* 为 `BilibiliCrawlerService` 适配 `PlatformCrawler` 接口：

  * `getTrendingVideos(category?, limit?)`：沿用“热门关键词搜索”的真实实现，不再回退 mock；必要时返回空数组。

  * `searchVideos(keyword, _platform?, limit?)`：忽略 `_platform`，内部固定使用 B站搜索真实数据，不再回退 mock；支持 `limit`。

  * `getUserVideos(usernameOrMid, limit?)`：说明使用 `mid`；若传用户名则通过额外查询（可后续拓展）。

  * `getUserInfo(usernameOrMid)`：同上，优先 mid。

* 统一输出结构字段：`id/title/description/thumbnail_url/video_url/duration/view_count/like_count/comment_count/share_count/created_at/author/{id,name,avatar_url}/tags/category/is_real_data`。

### 2. 路由改造（真实数据-only）

* `/api/videos/discover`：

  * 默认平台改为仅 `bilibili`；如果指定 `platform=bilibili` 则使用 Bilibili。

  * 移除模拟数据回退；真实抓取失败时返回空数组与提示。

  * 返回分页信息：`total`（不可用时返回 `videos.length`）、`page`、`limit`、`has_more`。

* `/api/videos/search`：

  * 同上，真实-only；按 `limit` 返回结果，移除 mock。

### 3. 前端兼容（若有 UI 文案）

* `src/services/videoAPI` 无需改动接口，但前端可提示“仅展示真实抓取，若无结果请更换关键词或平台”。

* 视频卡片展示沿用现有字段；移除对示例视频的依赖。

### 4. 稳定性与风控

* 适配 B站搜索接口的请求头与 Cookie（`buvid3/_uuid`），避免被拦截；若返回 `code != 0`，记录警告并返回空数组。

* 速率限制：保留现有 `express-rate-limit`，必要时在 `/videos` 路由加更严格限制。

### 5. 验证用例

* Discover：不传平台与类目，返回 B站真实热门搜索数据；传 `platform=bilibili&category=technology` 能返回科技类结果。

* Search：`q=周杰伦`、`q=评测` 等关键词返回真实结果。

* Edge：接口不可用或无结果时返回空数组（不使用模拟）。

## 交付与回归

* 移除所有模拟数据路径（仅保留真实抓取）。

* 启用 Bilibili 作为首个真实平台，后续可扩展其它平台爬虫。

* 不影响其他模块（发布/监控/任务等）。请确认后我将开始实现。

